!function(){var t={80:function(t){var e=$('meta[name="csrf-token"]').attr("content");var o={toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],popover:!1,callbacks:{onImageUpload:function(t){var o,a,n;o=t[0],a=this,(n=new FormData).append("image",o),n.append("_token",e),$.ajax({url:"/admin/upload/image",cache:!1,contentType:!1,processData:!1,data:n,type:"post",success:function(t){var e='<picture>\n                <source srcSet="/uploads/'.concat(t.urls.webp,'" type="image/webp">\n                <img src="/uploads/').concat(t.urls.original,'" alt="описание"/>\n            </picture>');$(a).summernote("pasteHTML",e)},error:function(t){console.log("error",t)}})}}};t.exports={module:{rules:[{test:/\.css$/,loader:"exports-loader",use:["style-loader","css-loader"]}]},token:e,summernote_config:o}}},e={};function o(a){var n=e[a];if(void 0!==n)return n.exports;var c=e[a]={exports:{}};return t[a](c,c.exports,o),c.exports}!function(){var t=o(80),e=t.token,a=t.summernote_config;function n(){$("#blockList").sortable({revert:!0,update:function(t,o){var a=$("#blockList").sortable("toArray");$.ajax({method:"POST",url:block_update_order_form_action,data:{_token:e,sequence:a},success:function(t){$("#blockList").sortable("destroy"),$("#blockList")[0].outerHTML=t.html,n(),$(document).Toasts("create",{class:"bg-success",title:"Статус",subtitle:"OK",body:"Последовательность блоков на странице успешно изменена",autohide:!0,delay:2e3})}})}}).disableSelection()}$(document).on("click",".remove-block",(function(t){t.preventDefault();var e=$("#deleteBlock")[0];e.dataset.url=this.dataset.url,e.dataset.block_id=this.dataset.block_id})),$("#deleteBlock").on("click",(function(){var t=this.dataset.block_id;$.ajax({method:"POST",url:this.dataset.url,data:{_token:e},success:function(e){$("#confirmDeleteBlock").modal("hide"),$("#".concat(t)).remove(),$(document).Toasts("create",{class:"bg-danger",title:"Статус",subtitle:"OK",body:"Блок удален",autohide:!0,delay:2e3})}})})),$(document).on("click",".edit-content",(function(t){$("#form_spiner").show(),$(".carousel").carousel(),$.ajax({method:"get",url:this.dataset.url,success:function(t){$("#form_spiner").hide(),$("#modal_body")[0].innerHTML=t.form,$(".editor").each((function(t){var e=this.id;$("#".concat(e)).summernote(a),$("#".concat(e))[0].value=$("#".concat(e)).summernote("code"),$("#".concat(e)).on("summernote.change",(function(t){$("#".concat(e))[0].value=$("#".concat(e)).summernote("code")}))})),$(".iterations").sortable({containment:"parent",items:"> div",handle:".move",tolerance:"pointer",cursor:"move",opacity:.7,revert:300,placeholder:"movable-placeholder",start:function(t,e){alert(2),e.placeholder.height(e.item[0].clientHeight),e.placeholder.width(.8*e.item[0].clientWidth)},update:function(t,e){alert(0);for(var o=0;o<t.target.children.length;o++)$(t.target.children[o]).find("input.order")[0].value=o+1}})}})})),$(document).on("change",".enable-block-switcher",(function(){var t,o,a=this;$("#".concat(this.dataset.block_id," .overlay")).show(),$.ajax({method:"POST",url:this.dataset.url,data:{_token:e,enabled:1*this.checked},success:function(e){a.checked?(t="bg-success",o="Блок включен"):(t="bg-danger",o="Блок выключен"),$("#blockList").sortable("destroy"),$("#blockList")[0].outerHTML=e.html,n(),$(document).Toasts("create",{class:t,title:"Статус",subtitle:"OK",body:o,autohide:!0,delay:2e3})}})})),$(document).on("click",".save-content",(function(t){$("#form_spiner").show();var o=this.dataset.close_form,a=$("#contentForm")[0];$(".editor").each((function(){var t=this.id;$("#".concat(t))[0].value=$("#".concat(t)).summernote("code")}));var n=new FormData(a);n.append("_token",e),$.ajax({method:"POST",url:a.action,data:n,dataType:"JSON",contentType:!1,cache:!1,processData:!1,success:function(t){$("#form_spiner").hide(),t.errors||t.status&&(o&&$("#contentFormModal").modal("toggle"),$(document).Toasts("create",{class:t.toasts.class,title:t.toasts.title,body:t.toasts.body,position:"bottomRight"}))}})})),$(document).on("click",".add-iteration",(function(t){var e=this;$.ajax({method:"GET",url:this.dataset.template_url,success:function(t){var o=document.createElement("template");"template_".concat(parseInt(1e5*Math.random()));e.previousElementSibling.append(o),o.outerHTML=t.html;for(var n=0;n<e.previousElementSibling.children.length;n++)$(e.previousElementSibling.children[n]).find("input.order")[0].value=n+1;$("#option_editor_".concat(t.u_id," .editor")).each((function(t){var e=this.id;$("#".concat(e)).summernote(a),$("#".concat(e))[0].value=$("#".concat(e)).summernote("code"),$("#".concat(e)).on("summernote.change",(function(t){$("#".concat(e))[0].value=$("#".concat(e)).summernote("code")}))}))}})})),$(document).on("change",".custom-file-input",(function(){var t=this.dataset.id,e=new FileReader,o=this.files[0];o&&(e.readAsDataURL(o),e.onload=function(e){var o=document.getElementById("image_".concat(t));$(o).show(),o.src=this.result})})),n(),$(".template-item").draggable({connectToSortable:"#blockList",helper:"clone",stop:function(t,o){$.ajax({method:"POST",url:block_create_content_form_action,data:{_token:e,enabled:1,block_template_id:t.target.dataset.template_id},success:function(t){t.errors||t.status&&($("#blockList").sortable("destroy"),o.helper[0].innerHTML=t.html,o.helper[0].id=t.block_id,n())}})}}),$(document).on("click",".content.remove-iteration",(function(t){return t.preventDefault(),confirm("Are you sure?")&&$.ajax({method:"DELETE",data:{_token:e},url:this.dataset.url,success:function(t){$("#".concat(t.id)).remove(),$(document).Toasts("create",{class:t.toasts.class,title:t.toasts.title,body:t.toasts.body,position:"bottomRight"})}}),!1})),$(document).on("click",".content.remove-new-iteration",(function(t){return t.preventDefault(),$("#".concat(this.dataset.id)).remove(),!1})),$(document).on("click",".block.clear-value",(function(){$("#optionFile_".concat(this.dataset.attr_id))[0].value="",$("#image_".concat(this.dataset.attr_id))[0].src="",$("#image_".concat(this.dataset.attr_id)).hide(),$("#contentForm").append('<input type="hidden" name="clear_value[]" value="'.concat(this.dataset.prop_id,'">'))}))}()}();
//# sourceMappingURL=list.js.map